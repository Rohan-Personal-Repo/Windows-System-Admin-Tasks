# TVActorDB – PowerShell + SQLite with PSSQLite

This project shows how to use **PSSQLite** as the SQLite connector in PowerShell to create a small TV actors database, load data from CSV, and query it.

---

## Steps

### 1. Install and import PSSQLite

1. Install the PSSQLite module from the PowerShell Gallery.  
2. Import the module in your PowerShell session.  
3. Optionally list available commands and read help for `Invoke-SqliteQuery` to understand query usage.[file:1]

---

### 2. Prepare the CSV data

1. Create a `TVShowActors.csv` file in the working directory.  
2. Include columns: `actorShowName`, `actorRealName`, `showName`.  
3. Add rows for each actor/character/show combination (e.g., Oliver Queen / Stephen Amell / Arrow).

---

### 3. Create the SQLite database and table

1. Choose a database file name, e.g. `TVActorDB.db`.  
2. Use `New-SqliteConnection` to create/open the database file.  
3. Drop the `ActorInfo` table if it already exists (for repeatable runs).  
4. Create the `ActorInfo` table with:
   - `showActorID` as an `INTEGER PRIMARY KEY AUTOINCREMENT`.  
   - `actorShowName`, `actorRealName`, `showName` as `TEXT` columns.  
5. Optionally use a `PRAGMA table_info(ActorInfo)` query to confirm the table structure.

---

### 4. Load CSV into a DataTable

1. Import the CSV file into PowerShell using `Import-Csv`.  
2. Inspect the NoteProperty members to get the column names.  
3. Create a `System.Data.DataTable` and add columns matching the CSV headers.  
4. Loop through CSV rows, create new DataTable rows, and populate:
   - `actorRealName`  
   - `actorShowName`  
   - `showName`  
5. Optionally display the DataTable in `Out-GridView` to validate the in‑memory data.

---

### 5. Bulk insert into SQLite

1. Call `Invoke-SQLiteBulkCopy` with:
   - The populated `DataTable`.  
   - The SQLite connection object.  
   - The destination table name `ActorInfo`.  
2. Confirm the bulk copy when prompted.  
3. PSSQLite will insert all rows; `showActorID` is auto‑generated by SQLite.

---

### 6. Verify data with a SELECT query

1. Use `Invoke-SqliteQuery` with a `SELECT` statement, e.g.:
   - `SELECT * FROM ActorInfo ORDER BY showName`.  
2. Pipe the results to `Out-GridView` (or format in the console) to inspect the stored records.  
3. Confirm that all CSV rows are present and correctly stored in the SQLite database.

---

### 7. Resources:
- [PSSQlite Module Install](https://www.powershellgallery.com/packages/PSSQLite/1.1.0)